<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Emacs Chat: Christopher Wellons (FFI, Emacs internals)</title>
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<link rel="stylesheet" type="text/css" href="http://sachachua.com/blog/wp-content/themes/sacha-v3/foundation/css/foundation.min.css"></link>
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'></link>
<link rel="stylesheet" type="text/css" href="http://sachachua.com/org-export.css"></link>
<link rel="stylesheet" type="text/css" href="http://sachachua.com/blog/wp-content/themes/sacha-v3/style.css"></link>
<link rel="stylesheet" type="text/css" href="css/emchat.css"></link>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script><script src="js/emchat.js"></script>
</head>
<body>
<div id="preamble" class="status">
<div class="sticky contain-to-grid top-menu"><nav class='top-bar'><ul class='links'>
      <li><a id='home' class='replace home-design' href='/emacs-chats/'>Home</a></li>
      <li><a id='index' class='replace show-for-medium-up home-design' href='/emacs-chats/theindex.html'>Index</a></li>
      <li><a id='contact' class='replace home-design' href='http://sachachua.com/blog/contact'>Contact</a></li>
      <li class="right"><a href='/emacs-chats/sitemap.html'>Sitemap</a></li> 
      <li class="right"><a href="https://github.com/sachac/emacs-chats">Github</a></li>
    </ul></nav></div>
</div>
<div id="content">
<h1 class="title">Emacs Chat: Christopher Wellons (FFI, Emacs internals)</h1>
<p>
<a href="http://sachachua.com/blog/2014/05/emacs-chat-christopher-wellons/">Source</a>
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Audio and Video</h2>
<div class="outline-text-2" id="text-1">
<iframe width="560" height="315" src="//www.youtube.com/embed/Hr06UDD4mCs" frameborder="0" allowfullscreen></iframe>

<p>
<b>Sacha:</b> Hello and welcome to another episode of Emacs chat. This time
with Christopher Wellons, who is, among other things, the author of
something that will play Tetris in Emacs for you.
</p>

<p>
<b>Sacha:</b> Hello Christopher, thank you for joining us.
</p>

<p>
<b>Christopher:</b> Hello.
</p>

<p>
I initially reached out to you because I read your blog post about
foreign function interfaces and all those other things, and then I
realized you are the same guy who put together skewer-mode and other
really, really cool interactive ways to use Emacs.
</p>

<p>
But before we dig into how you got into Emacs and all the interesting
things you do with it, can you tell us a little about who you are
outside of Emacs?
</p>

<p>
<b>Christopher:</b> I'm your typical computer geek. I've been using Emacs
for 9 years. I run regularly, I'm out there 3 days a week. I like
computer games. I like reading. I spend a lot time watching YouTube
videos actually. That's a big hobby. I find these long, half an hour
long clips, mostly people playing video games. So instead of playing
games myself I watch people play games. A lot of time I can do my own
thing while doing that, so it's almost like multitasking that way.
</p>

<p>
<b>Sacha:</b> You get all the benefits of the funny moments of the games
without having to do any of the hard work. I noticed on your blog that
you also make computer games? Like roguelikes?
</p>

<p>
<b>Christopher:</b> Occasionally. I like participating in the Seven Day
Roguelike (7DRL) contest every year. That's a fun thing to do for a
week. I like the constraints, but I only do it for about a week, then
I get to forget about it after that.
</p>

<p>
<b>Sacha:</b> You mentioned you started Emacs 9 years ago, which is pretty
amazing. How did you get into it?
</p>

<p>
<b>Christopher:</b> So I was on an internship in college, and I was getting
a lot more serious about programming. I've been programming for 19
years now. When doing the internship I was getting serious about it,
and up until that points I'd just been using KWrite and some other,
some basic stuff.
</p>

<p>
2:30
</p>

<p>
<b>Christopher:</b> I read probably something by Richard Stallman, or Steve
Yegge, some of his Lisp essays. I decided I should look into this
Emacs thing, and that's what ended up happening. I installed it and
read the manual. I got one of those O'Reilly Emacs books, I read that,
then just gradually built up from that point. It became my only text
editor quickly.
</p>

<p>
<b>Sacha:</b> Where you customizing it right away, or do you start off
using it as a programming environment for a while?
</p>

<p>
<b>Christopher:</b> I was customizing it right away, mostly copying and
pasting snippets here and there, because I didn't understand what a
lot it did. For example, this thing will tell me how many words are in
a buffer, and I dropped that into my configuration.
</p>

<p>
It wasn't until actually a few years ago that I put my Emacs config in
source control. So the whole thing is carefully curated now.
</p>

<p>
<b>Sacha:</b> So did you end up Emacs bankruptcy then and starting from
scratch when you started curating into your config.
</p>

<p>
<b>Christopher:</b> It's pretty close to from scratch. It got heavily
redone. I got a little macro to help me organize things and package
things up in a nice clean blocks. That happened at the same time I got
source control, almost like a rewrite.
</p>

<p>
<b>Sacha:</b> Now 9 years ago we didn't have a lot of the same resources we
have now about for learning more about Emacs configuration, no Github
&#x2026; I don't remember if EmacsWiki was around then. So you mentioned
the book was useful, the O'Reilly book, what are other resources you
found helpful?
</p>

<p>
<b>Christopher:</b> I gave away the O'Reilly book years ago, because that's
just a beginner book. I gave it to a coworker hoping to get her into
Emacs. But since then it's really just been primarily reading the
Emacs Lisp Reference Manual. There's still so much in that manual I
don't know about. I go through it all the time and I've gone through
it cover to cover a couple of times. There's still things I miss,
little details, and I go back like, "Oh, I didn't know you could do
this."
</p>

<p>
<b>Sacha:</b> Yeah, I find that every time I read the manuals, I came
across something new. Last time I reread the Emacs manual, I learned
how to add Unicode characters. There's just so much to learn.
Definitely reading the manual, and probably reading the source code as
well.
</p>

<p>
You mentioned coworker. You have other coworkers who are actually
using Emacs too?
</p>

<p>
5:26
</p>

<p>
<b>Christopher:</b> Yes, I've got a few coworkers. Not many. I spend time
discussing Emacs with all of them on occasion. Kind of sharing notes,
and how we do things. What's funny is pretty much all of them have
adopted the color theme. I went with the "wombat" color theme that
comes with Emacs. It seems everybody is using that now. That's kind of
fun to see that. "That looks familiar," when I see their screens.
</p>

<p>
<b>Sacha:</b> Yes it's interesting to see the diffusion of practices when
several people who use Emacs work together. Your config is on Github
so I guess people can pickup interesting tips off that one as well.
</p>

<p>
So you check with other people, learn from books, learn from source
code. All the hacking you've been doing about building web servers and
other interactive servers, you actually even put together something
that can talk to inferior Emacs processes? Or running Emacs within
Emacs or something of the sort?
</p>

<p>
<b>Christopher:</b> That was a project a couple weeks ago. I didn't even
announce it yet at this point.
</p>

<p>
<b>Sacha:</b> How do you get to the point where you are comfortable enough
with Emacs internals to just say, "Oh, I think I would like Emacs to
live with a web browser?"
</p>

<p>
<b>Christopher:</b> That's basically what it comes to. I can make it do
almost anything I want it to do right now. If I have an idea, I'm
going to try that, and that becomes my primary focus for a short
period of time until I make it work.
</p>

<p>
<b>Christopher:</b> To elaborate on that, I got a Steam account, I've got
something like 200, 300 games in there, but I rarely ever play them,
because these little programming activities are almost always more
fun. Like, I can play this game or I can tinker with Emacs. It's
almost always Emacs. Tinkering with Emacs sounds like more fun.
</p>

<p>
<b>Sacha:</b> Emacs is more addictive than games you can play on Steam.
I've heard that from other Emacs users as well, this is what we do for
relaxation and fun and intellectual curiosity.
</p>

<p>
So basically you learned about all these things by having crazy ideas.
Like What if I can use Emacs to play Tetris on its own. And then
digging around and figuring out how to do it.
</p>

<p>
<b>Christopher:</b> So you saw the autotetris-mode then?
</p>

<p>
( autotetris-mode <a href="https://github.com/skeeto/autotetris-mode">https://github.com/skeeto/autotetris-mode</a> )
</p>

<p>
<b>Sacha:</b> I just came across that today. I often show Tetris &#x2026; kind
of when you are demonstrating Emacs to other people and you want to
boggle their mind about just how much is in Emacs. So I normally show
things like Tetris and doctor and whatever and now I can show Tetris
and Autotetris, and drive people crazy.
</p>

<p>
Lots really odd and interesting things. One of the things that people
are often curious about is how actually people use Emacs. What's your
workflow like, what are the different things you've configured? And
you've shared your config on Github. ( <a href="https://github.com/skeeto">https://github.com/skeeto</a> )
</p>

<p>
But we like to see the highlights of your config. Particularly
interesting snippets that you like using.
</p>

<p>
<b>Christopher:</b> Sure. Should I switch to my screencast here then?
</p>

<p>
<b>Sacha:</b> And folks, you can ask questions by submitting to the Q &amp; A
app or adding them to the event page or if you are on IRC there's
emacs-chat channel on Freenode.
</p>

<p>
<b>Christopher:</b> So here is my init file. Something that will stand out
pretty quick: I've got this <code>with-package</code> macro here. You'll see that
show up over and over again. This is something I wrote myself. There
are a bunch of different versions. Everybody's kind of written their
own little version of this because there isn't an official one at this
point. It sort of groups related configurations options together into
a block. So instead of having all this loose stuff just kind of dumped
in, I can say, "Everything related to Uniquify goes in this block,
everything related to Eshell is going to go in this block right here."
</p>

<p>
<b>Christopher:</b> I don't have to list any of the packages explicitly. So
I use ELPA and MELPA. If I just mention it here in this
<code>with-package</code>, it will automatically get installed when Emacs starts
if it's not already installed.
</p>

<p>
<b>Sacha:</b> Humm, I should use that. I've been using <code>use-package</code> by
John Wigley ( <a href="https://github.com/jwiegley">https://github.com/jwiegley</a> ) but it doesn't do the
installs.
</p>

<p>
<b>Christopher:</b> I think <code>use-package</code> is another one of these macros
that somebody else has written and there are a few of them out there.
Mine's kind of cryptic. Like if you look at this entry here, I got
this asterisk. So the ones without the asterisk are lazily loaded. So,
they let Emacs load them with autoload as late as possible. Those with
asterisk are force loaded. Like uniquify, I don't want to wait for
something to happen for that to load, I want it just load right away,
so that it's active, so its got an asterisk on it. Same way with
<code>winner-mode</code>. With winner-mode, you can hop up with arrow keys back
and forth between buffers, I like doing that.
</p>

<p>
<b>Christopher:</b> Then there's asterisks on other things that has to do
with <code>auto-load</code>. It's pretty cryptic but it's really useful for me.
That why I haven't put this out there for other people to use.
</p>

<p>
<b>Sacha:</b> Sometimes you have asterisk after the package names?
</p>

<p>
11:55
</p>

<p>
<b>Christopher:</b> Yeah, that's something changed with <code>package.el</code>, in
the latest changes. It used to create a secondary package with the
same name but <code>-autoloads</code> and there's this really cool trick where
you could <code>require</code> the autoloads package and you can do some
configuration lazily. There's a nice trick, but I got rid of that.
There's no longer this autoloads package that's generated, so I had to
modify my <code>with-package</code> macro. So it has the same effect, and to do
that I have the asterisk on the package names when I want that effect.
</p>

<p>
12:41
</p>

<p>
<b>Christopher:</b> So in this case, I want it to make sure I load the
autoload of the <code>markdown-mode</code> &#x2013; something like that &#x2013; so when any
of these patterns are opened, it will get set in <code>markdown-mode</code>,
because the autoloads has already been set. It's something like that.
I can't remember the details right now.
</p>

<p>
13:11
</p>

<p>
Other than that, there's not too much special in here. Just a bunch of
things that I like to use. Like right here, I can quickly lookup Java
documentation. I got that down to <code>C-h j</code>. So normally you can lookup
documentation with <code>C-h f</code> so I can lookup Emacs stuff. Let's say I
want to lookup <code>ArrayList</code>. It'll pop up a browser over here.
</p>

<p>
And these are all the packages that's been loaded in this quick jump
stuff. And what makes this really work well is that Java's Javadoc is
ubiquitous. All these packages have Javadoc packeges made, so
documentation is in this nice clean format that I can jump to
anywhere. I can jump into Lombok documentation that's installed
locally on my machine by this process.
</p>

<p>
<b>Sacha:</b> Yeah that's good stuff. I often find myself Googling for all
these details, but it's nice to have that, just a quick keyboard
shortcut away.
</p>

<p>
<b>Sacha:</b> <code>multiple-cursors</code> is one of those thing I hear it's super
awesome, but I haven't got my mind around it yet.
</p>

<p>
<b>Christopher:</b> Yeah it lets me do this, and modify the stuff I want. I
love that. I used to do stuff like that with a macro, but
<code>multiple-cursors</code>, that's so much more comfortable.
</p>

<p>
<b>Sacha:</b> That's awesome.
</p>

<p>
<b>Christopher:</b> Something I did want to show was <code>impatient-mode</code> since
that was asked about specifically. So if you visit in your web browser.
</p>

<p>
( Impatient Mode. See the effect of your HTML as you type it.
 <a href="https://github.com/netguy204/imp.el">https://github.com/netguy204/imp.el</a>
 <a href="http://nullprogram.com/blog/2012/08/20/">http://nullprogram.com/blog/2012/08/20/</a> )
</p>

<p>
<b>Christopher:</b> You'll see if you click on the scratch buffer, you'll
see a copy of my scratch buffer here. And it has syntax highlighting.
(in a web browser)
</p>

<p>
<b>Sacha:</b> That's awesome! How will you use this?
</p>

<p>
<b>Christopher:</b> If I need to share my screen with somebody remotely,
this is easier than going through a normal kind of screen sharing
session like right this minute. I can just turn on <code>impatient-mode</code>,
and then give that URL, and they can visit that from a browser and
watch what I'm doing.
</p>

<p>
Its really useful if I pop up an <code>eshell</code> like this. I can run a shell
here and share that too. Now if I turn on <code>impatient-mode</code> like this,
now you be able to see this buffer too.
</p>

<p>
<b>Sacha:</b> Are you building any 2-way communication into this at some point?
</p>

<p>
<b>Christopher:</b> Nope, it's just one-way. And this is actually a
collaboration between me and Brian Taylor. He's a coworker and a
friend of mine.
</p>

<p>
( Brian Taylor's blog on impatient mode
<a href="http://www.50ply.com/blog/2012/08/13/introducing-impatient-mode/">http://www.50ply.com/blog/2012/08/13/introducing-impatient-mode/</a> )
</p>

<p>
It's built on the same web server, which I call <code>simple-httpd</code>, it's
the same one Skewer uses.
</p>

<p>
( skewer-mode <a href="https://github.com/skeeto/skewer-mode">https://github.com/skeeto/skewer-mode</a> Skewer: live web development with Emacs Provides live interaction with JavaScript, CSS, and HTML in a web browser. )
</p>

<p>
( simple-httpd <a href="https://github.com/skeeto/emacs-web-server">https://github.com/skeeto/emacs-web-server</a> )
</p>

<p>
Any time I'm doing something with Emacs that involves the web it's
using my little web server.
</p>

<p>
<b>Sacha:</b> I should try that too. It looks like you've put it to all
sorts of really good uses. You already have video demoing Skewer which
allows you to easily interact with the JavaScript in a browser. I
think it's pretty darn cool too.
</p>

<p>
<b>Sacha:</b> So there's <code>impatient-mode</code> and Skewer. So FFI, foreign
functions, how are you using that? I saw your blog post demonstrating
it, but am curious about the practical applications that you were
exploring.
</p>

<p>
( Emacs Lisp Foreign Function Interface <a href="https://github.com/skeeto/elisp-ffi">https://github.com/skeeto/elisp-ffi</a> )
</p>

<p>
<b>Christopher:</b> That kind of hit the wall a little bit, as it gets
complicated pretty quickly. I don't have any real practical uses for
it yet, I thought maybe I can run a GTK window, and run a little
graphical system that way. But as anybody who uses Linux and has
launched GTK applications from a terminal knows that they're really
noisy, they spits out a lot debugging messages. I haven't made it
robust enough, those messages actually interfere my communication with
Emacs. As it goes into pseudo-terminal and error messages and standard
messages get piped into the same pipe, and because of that it gets in
the way. I haven't done anything significant with that beyond just a
little demo, which I can show here really quick.
</p>

<p>
18:45
</p>

<p>
So am just going to copy right out of my README here and drop them
here. So, whenever you start using the FFI, it has to create what I
call a context, which is really just an inferior Emacs process that's
running my little FFI program. Its really simple. It's a stack machine
that I can send strings and basic values to, so I can say I've got
<code>srand</code>, so here's my function name, here's the function signature,
and it can push all these values into the stack, and pop the values
off and I get them in Emacs.
</p>

<p>
So here I can seed. If you know the C function <code>srand</code>, seeds the
random number generator. It returns a void. And I can start generating
random numbers.
</p>

<p>
<b>Sacha:</b> You said it's an inferior Emacs process?
</p>

<p>
<b>Christopher:</b> It's an inferior process. If I hop into here &#x2026; you
see those glue program? So it's just a C++ program that's linked
with libffi right here. And it just drives libffi through this really
simple protocol that it chats with through a pseudo-terminal, through
a pipe I am using.
</p>

<p>
It's just a pretty simple stack machine that makes it work. There's
the switch for the "byte code", and I can push different sizes of
integers onto the stack. And that created this little glue program
right here "ffi-glue." So that's what runs in the background.
</p>

<p>
<b>Sacha:</b> You mentioned you managed to get that to work as a package
and I was curious about how it all came together.
</p>

<p>
21:01
</p>

<p>
<b>Christopher:</b> If it's going to be a package, there's complications
such as how do you handle that binary. That's something I resolved
with EmacSQL.
</p>

<p>
(EmacSQL <a href="http://https://github.com/skeeto/emacsql">http://https://github.com/skeeto/emacsql</a> EmacSQL is a
 high-level Emacs Lisp front-end for SQLite (primarily), PostgreSQL,
 MySQL, and potentially other SQL databases.)
</p>

<p>
So that runs a sub-process in the background. In order to make that
work with SQLite out of the box as a package on MELPA, it ships with C
source code. It will attempt as best as it can to compile that when
you install it, so it might take a minute to install because its going
to run a C compiler synchronously to get that to work. I can try to
demonstrate it.
</p>

<p>
I'm going to make a SQLite database. This a connection object.
</p>

<p>
This is using a really cool part of Emacs, it came from CEDET, called
EIEIO, which I think is really clever.
</p>

<p>
( EIEIO
<a href="http://cedet.sourceforge.net/eieio.shtml">http://cedet.sourceforge.net/eieio.shtml</a>
EIEIO is an Emacs lisp program which implements a controlled
object-oriented programming methodology following the CLOS standard)
</p>

<p>
It's an object system a lot like Common Lisp's CLOS.
</p>

<p>
So these functions, there's also [interface for] MYSQL and also
PostgreSQL one, actually 2 PostgreSQL drivers, I can do this, this is
the database name, called "testing."
</p>

<p>
It'll create this database object, thanks to EIEIO, it'll work with
all the same, because they are generic functions it'll work with the
same functions. So once you have this database object, you don't care
what's there anymore, you can just use this same EmacSQL function to
make queries on it.
</p>

<p>
I can say create-table, like this:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(emacsql db [<span style="font-weight: bold;">:create-table</span> foo ([name id])])
</pre>
</div>

<p>
and I can insert values into it:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(emacsql db [<span style="font-weight: bold;">:insert-into</span> foo <span style="font-weight: bold;">:values</span>])
</pre>
</div>

<p>
Notice this is a s-expression, so instead of doing
</p>

<div class="org-src-container">

<pre class="src src-sql">SELECT * FROM foo
</pre>
</div>

<p>
I build up these vectors of symbols and it actually compiles into SQL
expressions. I can demonstrate that.
</p>

<p>
So here's a expression,
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(emacsql db [<span style="font-weight: bold;">:insert-into</span> foo <span style="font-weight: bold;">:values</span> [<span style="font-style: italic;">"Chris"</span> 0]])
</pre>
</div>

<p>
I can compile that right there.
</p>

<p>
Output:
</p>

<p>
INSERT INTO foo VALUES ('"Chris"', 0);
</p>

<p>
That's what it compiles to.
</p>

<p>
<b>Christopher:</b> Then I can make queries on the database.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(emacsql db [<span style="font-weight: bold;">:select</span> * <span style="font-weight: bold;">:from</span> foo])
((<span style="font-style: italic;">"Chris"</span> 0))
</pre>
</div>

<p>
About the extra quoting. I'm not sure I made the right choice on this.
Anything that's not a number. First, <code>nil</code> maps to <code>NULL</code>. I can
insert a <code>NULL</code> into database just by using a <code>nil</code> there. Anything
not <code>nil</code> or a number, will get printed into a string, and that whole
value is inserted into the database.
</p>

<p>
26:00
</p>

<p>
<b>Sacha:</b> What got you interested in building this in the first place?
</p>

<p>
<b>Christopher:</b> It goes back to Elfeed, which is my web feed reader.
</p>

<p>
(Elfeed
<a href="https://github.com/skeeto/elfeed">https://github.com/skeeto/elfeed</a>
Elfeed is an extensible web feed reader for Emacs, supporting both
Atom and RSS. It requires Emacs 24 and is available for download from
MELPA. Elfeed was inspired by notmuch.)
</p>

<p>
Skewer mode is probably my most used Emacs package right
now. But the most useful for me has been Elfeed.
</p>

<p>
I created it after Google Reader shutdown. I wasn't happy with any of
the alternatives, so I thought, I could do better than all these, I'll
write my own, that's what I ended up doing.
</p>

<p>
<b>Christopher:</b> So I wrote this in August last year, I wrote EmacSQL
around the beginning of this year. Back in August when I wrote Elfeed,
I needed a database to store all this stuff in. So if I clear this
out, you going to see just the last 10 weeks (of blog feed entries).
These are all the different entries I've read and looked at.
</p>

<p>
In last 10 weeks there's been 2,451 entries. These are all stored in
the database. You see all these tags, the green on the right. These
tags, I can go into these, look at the content inside. Here's an
Irreal post, that would be likely about Emacs. So I can read them here
right inside Emacs.
</p>

<p>
28:55
</p>

<p>
<b>Sacha:</b> I saw in your screenshot you have images working in this, too.
</p>

<p>
<b>Christopher:</b> Oh yeah. There you go. There's one, this is my own blog.
So I can read my own posts right here in Emacs. And go back and forth
between posts here.
</p>

<p>
That's where EmacSQL comes in. I need a database to store all these
info, and efficiently index it. If you look down at the bottom here, I
press s. I got this filter. You see this:
</p>

<p>
Filter: -junk @10-weeks-ago nullproam
</p>

<p>
I start to type my blog name in, and you see live filtering.
</p>

<p>
Let's say I want to see everything with the tag +youtube
</p>

<p>
Filter: -junk @10-weeks-ago +youtube
</p>

<p>
It shows all YouTube stuff in the last 10 weeks. I can narrow it
down to 4 weeks, or 1 day ago.
</p>

<p>
<b>Sacha:</b> I like that. Really cool stuff.
</p>

<p>
<b>Christopher:</b> So I need to search this fast, and I end up writing my
own database format.
</p>

<p>
<b>Christopher:</b> There's no database really suitable for this in Emacs,
that's why I struck out to write EmacSQL to try to provide a database,
so it'll never have to be done again.
</p>

<p>
I started to port Elfeed to EmacSQL, it's not finished yet. Am not
sure I really want to do that or not, but that's something possible in
the future.
</p>

<p>
<b>Sacha:</b> So sounds like you spend fair bit of your life inside Emacs.
You read blogs, web browsers, and other things&#x2026; what else do you do
inside Emacs?
</p>

<p>
<b>Christopher:</b> So I do email too. I prefer Notmuch as my email client.
</p>

<p>
( Notmuch <a href="http://notmuchmail.org/">http://notmuchmail.org/</a> )
</p>

<p>
<b>Sacha:</b> I heard good things about it. What do you like about it?
</p>

<p>
<b>Christopher:</b> so you notice, it looks pretty similar to Elfeed. You see tags on the right. It actually inspired the interface for Elfeed.
</p>

<p>
I like how fast the searching is, how quickly everything is.
</p>

<p>
<b>Sacha:</b> I'm going to give it a try. I've been using GNUS. I thought
it's interesting.
</p>

<p>
<b>Christopher:</b> I did try mu4e. I tried it and I didn't like it as much
as Notmuch.
</p>

<p>
<b>Sacha:</b> So you use mail&#x2026; your config mentioned you use calc. Do you
use it just as a calculator or do you have any other fancy things for
it?
</p>

<p>
<b>Christopher:</b> Pretty much as a arbitrary precision calculator.
</p>

<p>
lots times&#x2026; what's 2<sup>128</sup> it's useful.
(computes 2<sup>128</sup>)
</p>

<p>
and if I need to do units, it'll keep tracking it for me. S for
seconds change it to year. This is really handy. 5
</p>

<p>
<b>Sacha:</b> That's great. I see the hang of all these things. Calc is
great, it's like a microcosm in Emacs. This absurdly powerful and
flexible thing.
</p>

<p>
<b>Christopher:</b> It can do calculus. It's a full computer algebra
system. It's not fair to call it a calculator really, because it's so
much more than that.
</p>

<p>
<b>Sacha:</b> So you write a lot Markdown in your config?
</p>

<p>
<b>Christopher:</b> Oh yeah. I write my blog in Markdown. All those posts are
Markdown. All the READMEs. I just prefer Markdown for all my
documentation.
</p>

<p>
I haven't made the jump to ord-mode yet. I've never learned enough
about it to make good use of it. I know you love org mode right?
</p>

<p>
<b>Sacha:</b> I find it to be similarly flexible. You can do all sort of
things with it. But you've got lots of things in Markdown, basically
that's the way your brain works. I guess org mode is similar, but the
syntax is different. There's a little bit of friction to get over.
</p>

<p>
If you are not using org mode, are there other ways you manage
your tasks?
</p>

<p>
<b>Christopher:</b> Outside of this I'm not actually all that organized. I
just work from my head lots of the time, more than I should. I forget
things, not even knowing I forget them.
</p>

<p>
<b>Sacha:</b> You've to write lots of large software, all kept in your head,
so&#x2026; wow.
</p>

<p>
<b>Christopher:</b> There's something about Elfeed. I noticed you are
writing a post about&#x2026; You logged all your activities, you track how
much time you spending on all these various things. I recently came up
with Elfeed is&#x2026; on the side of my website, you'll see these lists of
places (blogs) that I recommend checking out. These huge list. I was
kind of manually maintaining these lists, until recently, I realized I
can tab the Elfeed database to fill these out for me, since am already
maintaining all these stuff in Elfeed.
</p>

<p>
Here's how I worked out. Here's my blogs. Here's where the list come
from. A list of blogs I was recommending. I wrote this function called
jekyll insert-url and I got a little filter string here
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">&lt;!-- (jekyll/insert-urls <span style="font-style: italic;">"+blog -product -myself "</span>) --&gt;
</pre>
</div>

<p>
So I can just run this. It'll evaluate it right in the buffer.
</p>

<p>
Oh, it's supposed to be working.
</p>

<p>
<b>Sacha:</b> That's alright, it's the nature of all demos, to have
something go wrong.
</p>

<p>
<b>Sacha:</b> I see the idea. Since you already have all the data anyway you
might as well use the same interface for searching for tags or
whatever, you might even consider kind of capturing your reading data,
and organizing into a list so the stuff you like reading more show up
earlier in the list.
</p>

<p>
<b>Christopher:</b> Yeah. That's something I should probably track more. As I
read things or rate them and somehow capture that info and track them
in Elfeed, as I got a database right there I can capture the info and
make use of it in the future.
</p>

<p>
<b>Sacha:</b> Cool. So you do a heck lots of things in Emacs. Anything you
haven't got around to do in Emacs yet?
</p>

<p>
<b>Christopher:</b> There's a barrier for me to learn new programming
languages. This touches on Skewer mode. Is that. Before I get into a
language I want to have a workflow set up in emacs the way I like it.
That's how Skewer came about. I need to learn JavaScript and web
development, and I need to find some workflow in Emacs to make it
work, and I looked at swing.js and it didn't quite do what I was
looking for, and ended up writing Skewer mode while I learn
JavaScript.
</p>

<p>
<b>Sacha:</b> You want to learn JavaScript, so you developed something in
Emacs that talk interactivity using JavaScript to a browser, ending up
writing however many lines of code in JavaScript to communicate with
Emacs process.
</p>

<p>
<b>Christopher:</b> Yes.
</p>

<p>
<b>Sacha:</b> In order to learn JavaScript?
</p>

<p>
<b>Christopher:</b> Yes. It's part of learning. A good exercise too.
</p>

<p>
<b>Sacha:</b> That's totally awesome. I was thinking you've been doing this
for a while, like years of experience with JavaScript and got really
tired of the round trip or whatever. So, your first step into this is
really cool.
</p>

<p>
<b>Christopher:</b> I can demo how that works real quick.
</p>

<p>
So I say <code>run-skewer</code> and it opens a blank tab here in browser that's
connected to Emacs and I pop up a JavaScript scratch buffer. I got a
scratch buffer for every language.
</p>

<p>
I can write JavaScript expressions
</p>

<div class="org-src-container">

<pre class="src src-js">Math.pow(13,2.1)
</pre>
</div>

<p>
[result shows under the expression]
</p>

<p>
There's a REPL
</p>

<p>
<b>Sacha:</b> I love the profusion of REPLS you have.
</p>

<p>
<b>Christopher:</b> Yeah. I love REPLS. I love live systems. Steve Yegge has
a real well-done essay about live systems, about why they are
powerful, I recommend checking that out. You can probably find it on
Google pretty quick.
</p>

<p>
So this is connected to the tab right here. To prove that, I can
switch to my CSS scratch buffer. I want the background
to be red, and I evaluate just like in Emacs lisp. I press <code>C-x C-e</code>.
</p>

<p>
<b>Christopher:</b> And I want JavaScript here. I switch to a HTML buffer&#x2026;
Selector&#x2026; insert the page this part is a bit crude I haven't got
this refined yet. It's got limited use. Say I want to insert a heading
to the page.
</p>

<p>
and I can evaluate this <code>&lt;h1&gt;</code> just as if it's an expression. You can
see it on the screen.
</p>

<p>
[demo of live change of HTML/CSS]
</p>

<p>
41:52
</p>

<p>
<b>Sacha:</b> How to you save it afterward?
</p>

<p>
<b>Christopher:</b> You can just save the buffer, but that might not be
sufficient. There's really no way to capture right now.
</p>

<p>
You can see that it's just building up CSS style sheets on the page,
it's messy. So am not sure one would want to capture it as is.
</p>

<p>
<b>Sacha:</b> It's really good for experimentation. I can see how the live
workflow is really great for feedback. Even hitting the refresh after
changing the CSS is just a little bit more friction.
</p>

<p>
<b>Christopher:</b> Yes, I hate that so much I want to treat web development
as a live system I can hack while it is being build.
</p>

<p>
I can do further with this. So here's my blog again, you see this
little green triangle on the top right corner, I can click and toggle
that. When it's green, that mean Skewer can edit this page. This works
not just with my blog. There's a little browser extension I wrote to
make it work with Skewer. I can toggle this on any page. For example
if I'm on Github&#x2026; although this wont work with Github website
because they've got security cranked up so much they won't let this
work.
</p>

<p>
I can hook into it, and come over to Emacs and execute JavaScript code
on that page, and same for CSS. This way, I can tab into any page and
do anything to make it work.
</p>

<p>
<b>Sacha:</b> I have to go to get that setup, definitely.
</p>

<p>
I guess you use that for a lot development?
</p>

<p>
<b>Christopher:</b> That made JavaScript one of my preferred language
actually. Because, there's WebGL now, and HTML5, CANVAS. If I need to
write a program live that has a graphical interface, I can hack this up
without ever refreshing a page.
</p>

<p>
<b>Sacha:</b> You mean like Foreign Function Interface?
</p>

<p>
<b>Christopher:</b> That's what I was doing before I started&#x2026;
</p>

<p>
I got is this cool thing with it. If you are familiar with Voronoi
diagram. This is WebGL. The original ideas was that I can write a
shader for each pixel on the screen, it compares to every vertex and
colors itself appropriately. The GPU is very good at this. I came up
with a even better version involving 3-dimensional cones and a depth
buffer that's a lot faster. That's why I got this out, you can
actually drag these around, just like this.
</p>

<p>
It's a little slow on this machine because I'm using plain open source
drivers which is not as fast as on a machine with real video drivers.
</p>

<p>
It's pretty fast considering it's not actually [not using Voronoi
diagram specific algorithm]. There's something called Fortune's
algorithm that has sweep lines that travels across and doing all this
stuff, but this is really just a brute force with the graphics card
doing most of the work.
</p>

<p>
Its developed live with Skewer like this. I can change the shaders and
update the page while it's running, trying things out, without
refreshing the page.
</p>

<p>
<b>Sacha:</b> You are working with a lot cool things. One thing I want to
mention, because it's also really cool too but non-technical. You have
released all these things into the public domain?
</p>

<p>
How you made that decision? What got you interested, and how's that
played out?
</p>

<p>
<b>Christopher:</b> I started out using GPL about 7 years ago. I read Richard
Stallman's Free Software and free society, and actually have a signed
version of that. I got really into FSF and got a membership, and
everything I did was licensed under GPL.
</p>

<p>
As I got more experience, I find that licenses are cumbersome. If I
want to use even just a snippet of somebody's code, to formally follow
the license I gotta list their names, follow all these rules to make
it work. It's cumbersome to worry about these license stuff all the
time, especially if the software got large involving all these
licenses, even if it's just the 3-clause BSD license that just require
credit. So I decided I didn't want any part of that, I just want to
make my code as useful as it can be to most people as possible. I do
that by putting it in public domain. Nobody's got any obligation to me
when they use this stuff.
</p>

<p>
<b>Sacha:</b> Thank you for doing that. It's great that you sharing them so
freely.
</p>

<p>
Do you have any other tips for people getting into Emacs internals or
playing around with some of these cool stuff?
</p>

<p>
<b>Christopher:</b> You have Emacs source code, sometimes not everything is
documented clearly in the docstring, so you might have to dig into
source code to see how it works, or if you have bugs, a lot of times
you need to dig into the source code to see what's wrong.
</p>

<p>
I actually don't read the Emacs manual much&#x2026; it's kind of high level
and not really useful for hacking Emacs. The real useful manual is the
Emacs Lisp Reference Manual. It comes with Emacs. You can see in the
info page here. <code>C-h i</code>
</p>

<p>
It covers everything, or almost everything. You can see how big it is.
This index is 1400 lines. For example, I want to see how process
works. I can just search the string processes and read about how it
works. There's a lot sections and features I'm not aware of and I got
surprised by all the time.
</p>

<p>
So, use the Emacs Lisp Reference to see all Emacs can do and you can
hack it. Occasionally you have to dig into Emacs source code to see
how things work. My recent example of that is, in Elfeed there's a
bug, where somebody want to use <code>x-get-selection</code>. How this function
is defined depends on what platform you are on. The doc string for
<code>x-get-selection</code> doesn't really elaborate how it works for each
platform. What's convenient about this is there's link to the source
code, see this `select.el'? I got a keyboard shortcut that can jump
right into the source code. So you see here's the source code for
<code>x-get-selection</code>.
</p>

<p>
<b>Sacha:</b> Sometimes I find myself needing to dig into the C source code
as well?
</p>

<p>
<b>Christopher:</b> Yeah. That's another way how I got into the Emacs
internals. I've written 2 lisp interpreters. One of them I wrote,
which is a crappy toy lisp. Another one is with Brian Taylor I
mentioned before, we wrote a scheme interpreter together.
</p>

<p>
I have experience of how lisp is put together internally, so I can
look at Emacs and see lots similarities and understand what's going on
and navigate my way around.
</p>

<p>
<b>Sacha:</b> Did you do lisp before coming into Emacs or the other way
around?
</p>

<p>
<b>Christopher:</b> It's hard to say. It might've been that lisp interested
me and I got into Emacs initially, but as I said it was 9 years ago I
started Emacs and it was both lisp and Emacs that got me into it at
the same time, so I can't remember which came first. They kind of came
hand-in-hand.
</p>

<p>
Some people online asks "how do you get into Common Lisp?" and one of
the answer is Emacs, that's one of the most powerful editor for lisp
right now.
</p>

<p>
<b>Sacha:</b> It made sense. Lots people have build very interesting things
on top of it.
</p>

<p>
Thanks for sharing your workflow. It looks really cool.
</p>

<p>
<b>Christopher:</b> Thanks.
</p>

<p>
<b>Sacha:</b> That certainly gave me lots of things to play around after
this, and I hope a lot people both listening and afterward get to play
with this too. Thank you again so much for taking your time to share
you workflow.
</p>

<p>
Another curiosity. I'm doing these Emacs chats as a way for other
people to get to how how people use Emacs, how did they got into it,
what kind of cool things people are working on. Is there anyone you
like to see in one of this episode?
</p>

<p>
<b>Christopher:</b> If I were to pick a name I would say Steve Purcell He's
the curator of MELPA right now.
</p>

<p>
( Steve Purcell's Github <a href="https://github.com/purcell/emacs.d">https://github.com/purcell/emacs.d</a> )
</p>

<p>
<b>Sacha:</b> Where's the best place for people to find you?
</p>

<p>
<b>Christopher:</b> My blog or my Github. You can just email me. If it's
related to my packages, you can just open a issue on Github, I get to
it pretty quick.
</p>

<p>
<a href="http://nullprogram.com/">http://nullprogram.com/</a>
</p>

<p>
<a href="https://github.com/skeeto/">https://github.com/skeeto/</a>
</p>

<p>
<b>Sacha:</b> Thanks everyone for listening in. You can find the
broadcasting on Google Plus events page and it would also be available
on <a href="http://emacslife.com/">http://emacslife.com/</a> eventually once we get the page and
transcript and other good things sorted out, and it would be in public
domain as well.
</p>

<hr>
<p>
Check out <a href="http://sachachua.com/blog/emacs-chat">Emacs Chat</a> for more interviews like this. Got a story to tell about how you learned about or how you use Emacs? <a href="http://sachachua.com/blog/contact">Get in touch!</a>
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Comments</h3>
<div class="outline-text-3" id="text-1-1">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_url = "http://sachachua.com/blog/2014/05/emacs-chat-christopher-wellons/";
    var disqus_shortname = 'sachac'; // Required - Replace example with your forum shortname
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<div class="back-to-top"><a href="#top">Back to top</a> | <a href="mailto:sacha@sachachua.com">E-mail me</a></div>
</div>
</body>
</html>
